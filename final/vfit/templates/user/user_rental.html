{% extends "base.html" %}
{% load humanize %}
{% block content %}
<div class=" text-gray-100 font-poppins min-h-screen pt-20">
    <div class="flex">
        {% include 'user/menu.html' %}
        <div class="w-3/4 p-8 ml-6 mb-6 mr-8">
            <div class="flex justify-start mb-6 -mt-8 -mr-8 -ml-8">
                <div id="tab-history" class="w-1/2 bg-black bg-opacity-50 py-4 px-4 shadow-md border-b-2 border-yellow-400 text-yellow-500 text-xl text-center cursor-pointer">
                    ประวัติ
                </div>
                <div id="tab-address" class="w-1/2 text-xl bg-gray-500 py-4 px-4 shadow-md text-yellow-600 hover:bg-gray-300 hover:text-yellow-500 text-center cursor-pointer">
                    ที่อยู่
                </div>
            </div>
            <div class="w-full h-full overflow-hidden">
                <div class="p-8 overflow-y-auto h-[calc(100%-4rem)]">
                    <div>
                        {% for rental in rental_history %}
                            <div class="flex items-center text-white border-b-2 p-4">
                                <img src="{{ rental.product.image.url }}" alt="{{ rental.product.name }}" class="w-20 h-20 rounded mr-4">
                                <div class="flex-1">
                                    <h3 class="font-bold">{{ rental.product.name }}</h3>
                                    <p>วันที่รับ: {{ rental.get_date|date:"d/m/Y" }}</p>
                                    <p>วันที่คืน: {{ rental.return_date|date:"d/m/Y" }}</p>
                                    {% if rental.status == 'renting' %}
                                    <p class="text-green-500">เวลาที่เหลือ: {{ rental.time_remaining }} วัน</p>
                                    {% elif rental.status == 'overdue' %}
                                    <p class="text-red-500">เกินกำหนดเวลา: {{ rental.overdue_time }} วัน</p>
                                    {% else %}
                                    <p class="text-gray-500">สถานะ: {{ rental.get_status_display }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        {% empty %}
                        <p class="text-center text-gray-500">ไม่มีประวัติการเช่า</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // อัปเดตเวลาทุก 60 วินาที (ถ้าแสดงข้อมูลสด)
    setInterval(() => {
        location.reload();
    }, 60000);
</script>
{% endblock %}